var Ge=Object.defineProperty,Be=Object.defineProperties;var Ke=Object.getOwnPropertyDescriptors;var re=Object.getOwnPropertySymbols;var Te=Object.prototype.hasOwnProperty,Se=Object.prototype.propertyIsEnumerable;var ve=(e,t,n)=>t in e?Ge(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ue=(e,t)=>{for(var n in t||(t={}))Te.call(t,n)&&ve(e,n,t[n]);if(re)for(var n of re(t))Se.call(t,n)&&ve(e,n,t[n]);return e},fe=(e,t)=>Be(e,Ke(t));var de=(e,t)=>{var n={};for(var i in e)Te.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&re)for(var i of re(e))t.indexOf(i)<0&&Se.call(e,i)&&(n[i]=e[i]);return n};import{S as B,i as K,s as V,e as p,t as D,a as k,b as u,c as W,d as v,f as g,n as I,l as z,g as S,h as Fe,r as ge,j as Ve,k as te,w as ae,m as Je,o as me,p as he,N as we,U as Ye,q as Ze,u as ze,D as Oe,v as pe,x as Qe,y as Xe,z as G,A as ye,G as je,L as Q,B as Re,C as X,E as ce,F as R,H as J,I as Y,J as L,K as Z,M as j,O as x,P as xe,Q as et,R as tt,T as ee,V as nt,W as it,X as ot,Y as rt,Z as lt,_ as st,$ as at}from"./vendor.4e92549a.js";const ct=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}};ct();function Ue(e){let t,n,i;return{c(){t=p("ion-item"),n=p("ion-label"),i=D(e[1])},m(o,r){k(o,t,r),u(t,n),u(n,i)},p(o,r){r&2&&W(i,o[1])},d(o){o&&v(t)}}}function Ce(e){let t,n;return{c(){t=p("ion-item"),n=p("ion-input"),g(n,"placeholder","Full Name"),g(n,"type","text"),g(n,"required","")},m(i,o){k(i,t,o),u(t,n),e[8](n)},p:I,d(i){i&&v(t),e[8](null)}}}function Ie(e){let t,n,i,o;return{c(){t=p("ion-item"),n=p("ion-input"),g(n,"placeholder","confirm password"),g(n,"type","password"),g(n,"required","")},m(r,l){k(r,t,l),u(t,n),e[11](n),i||(o=z(n,"keypress",e[7]),i=!0)},p:I,d(r){r&&v(t),e[11](null),i=!1,o()}}}function ut(e){let t,n,i,o=e[0]?"Sign up":"Login",r,l,s,a,c,f,m,w,_,h,d,T,b,U=e[0]?"Sign up":"Login",A,y,C,O=e[0]?"Login instead":"Sign up instead",E,H,ke,$=e[1]!==""&&Ue(e),M=e[0]&&Ce(e),N=e[0]&&Ie(e);return{c(){t=p("ion-header"),n=p("ion-toolbar"),i=p("ion-title"),r=D(o),l=S(),s=p("ion-list"),$&&$.c(),a=S(),M&&M.c(),c=S(),f=p("ion-item"),m=p("ion-input"),w=S(),_=p("ion-item"),h=p("ion-input"),d=S(),N&&N.c(),T=S(),b=p("ion-button"),A=D(U),y=S(),C=p("ion-button"),E=D(O),g(t,"translucent",""),g(m,"placeholder","email"),g(m,"type","text"),g(m,"required",""),g(m,"autofocus",""),g(h,"placeholder","password"),g(h,"type","password"),g(h,"required",""),g(b,"expand","block"),g(s,"lines","full")},m(P,F){k(P,t,F),u(t,n),u(n,i),u(i,r),k(P,l,F),k(P,s,F),$&&$.m(s,null),u(s,a),M&&M.m(s,null),u(s,c),u(s,f),u(f,m),e[9](m),u(s,w),u(s,_),u(_,h),e[10](h),u(s,d),N&&N.m(s,null),u(s,T),u(s,b),u(b,A),k(P,y,F),k(P,C,F),u(C,E),m.focus(),H||(ke=[z(h,"keypress",function(){Fe(e[0]?void 0:e[7])&&(e[0]?void 0:e[7]).apply(this,arguments)}),z(b,"click",e[6]),z(C,"click",e[12])],H=!0)},p(P,[F]){e=P,F&1&&o!==(o=e[0]?"Sign up":"Login")&&W(r,o),e[1]!==""?$?$.p(e,F):($=Ue(e),$.c(),$.m(s,a)):$&&($.d(1),$=null),e[0]?M?M.p(e,F):(M=Ce(e),M.c(),M.m(s,c)):M&&(M.d(1),M=null),e[0]?N?N.p(e,F):(N=Ie(e),N.c(),N.m(s,T)):N&&(N.d(1),N=null),F&1&&U!==(U=e[0]?"Sign up":"Login")&&W(A,U),F&1&&O!==(O=e[0]?"Login instead":"Sign up instead")&&W(E,O)},i:I,o:I,d(P){P&&v(t),P&&v(l),P&&v(s),$&&$.d(),M&&M.d(),e[9](null),e[10](null),N&&N.d(),P&&v(y),P&&v(C),H=!1,ge(ke)}}}function ft(e,t,n){const i=Ve();function o(){!a||!c||r&&!f||i("submit",{name:s?s.value:void 0,email:a.value,password:c.value,confirmPassword:f?f.value:void 0,signup:r})}let{signup:r=!1}=t,{errorNote:l=""}=t,s,a,c,f;function m(b){b.key==="Enter"&&o()}function w(b){te[b?"unshift":"push"](()=>{s=b,n(2,s)})}function _(b){te[b?"unshift":"push"](()=>{a=b,n(3,a)})}function h(b){te[b?"unshift":"push"](()=>{c=b,n(4,c)})}function d(b){te[b?"unshift":"push"](()=>{f=b,n(5,f)})}const T=()=>n(0,r=!r);return e.$$set=b=>{"signup"in b&&n(0,r=b.signup),"errorNote"in b&&n(1,l=b.errorNote)},[r,l,s,a,c,f,o,m,w,_,h,d,T]}class dt extends B{constructor(t){super();K(this,t,ft,ut,V,{signup:0,errorNote:1})}}const pt=(e,t)=>{const n=localStorage.getItem(e),i=ae(n?JSON.parse(n):t);return i.subscribe(o=>localStorage.setItem(e,o?JSON.stringify(o):"")),i},le=ae(!1),q=ae(null),_e=ae(null),se=pt("currentTrip",null),mt=e=>{se.update(t=>t?(t.geopoints=[...t.geopoints,{timestamp:new Date().toISOString(),location:e}],t):null)},be=e=>{if(!e.length)return 0;let t=0;for(let n=1;n<e.length-1;++n)t+=Je(e[n-1],e[n]);return t},_t={toFirestore:e=>({name:e.name,email:e.email,credits:e.credits,redeemedRewards:e.redeemedRewards}),fromFirestore:(e,t)=>{const n=e.data(t);return{name:n.name,email:n.email,credits:n.credits,redeemedRewards:n.redeemedRewards}}},He={toFirestore:e=>({id:e.id,userEmail:e.userEmail,startTime:me.fromDate(e.startTime),endTime:e.endTime?me.fromDate(e.endTime):null,transportType:e.transportType,distance:e.distance,geopoints:e.geopoints}),fromFirestore:(e,t)=>{const n=e.data(t);return{id:n.id,userEmail:n.userEmail,startTime:n.startTime.toDate(),endTime:n.endTime?n.endTime.toDate():null,transportType:n.transportType,distance:n.distance,geopoints:n.geopoints}}},We={toFirestore:e=>({id:e.id,name:e.name,description:e.description,price:e.price,provider:e.provider,expiration:me.fromDate(e.expiration),remainingUnits:e.remainingUnits}),fromFirestore:(e,t)=>{const n=e.data(t);return{id:n.id,name:n.name,description:n.description,price:n.price,provider:n.provider,expiration:n.expiration.toDate(),remainingUnits:n.remainingUnits}}},oe=()=>Ye(),qe=e=>we(oe(),"users",e).withConverter(_t),bt=e=>we(oe(),"trips",e.id).withConverter(He),gt=e=>we(oe(),"rewards",e.id).withConverter(We),ht=async e=>{const o=e,{redeemedRewards:t}=o,n=de(o,["redeemedRewards"]),i=fe(ue({},n),{redeemedRewards:t.map(r=>r.id)});await he(qe(e.email),i)},wt=async e=>{await he(bt(e),e)},yt=async e=>{await he(gt(e),e)},kt=async e=>{const t=await Ze(qe(e));if(!t.exists())return null;const n=t.data(),s=n,{redeemedRewards:i}=s,o=de(s,["redeemedRewards"]),r=await vt(n.email),l=(await Ae()).filter(a=>(i||[]).includes(a.id));return fe(ue({},o),{trips:r,redeemedRewards:l})},vt=async e=>{const t=[];return(await ze(Oe(oe(),"trips").withConverter(He))).forEach(i=>i.exists()&&t.push(i.data())),t.filter(i=>i.userEmail===e)},Ae=async()=>{const e=[];return(await ze(Oe(oe(),"rewards").withConverter(We))).forEach(n=>n.exists()&&e.push(n.data())),e};var ne={fetchUser:kt,fetchAllRewards:Ae,updateUser:ht,updateTrip:wt,updateReward:yt};function Tt(e){let t,n,i,o,r,l,s,a,c;return{c(){t=p("ion-content"),n=p("ion-fab"),i=p("ion-fab-button"),o=p("ion-icon"),l=S(),s=p("div"),g(o,"name",r=e[0]?"close":"add"),g(n,"horizontal","center"),g(n,"vertical","bottom"),g(n,"slot","fixed"),pe(n,"pointer-events","auto"),Qe(s,"class","map svelte-vsoji2"),pe(s,"height","100%"),pe(s,"width","100%"),g(t,"fullscreen","")},m(f,m){k(f,t,m),u(t,n),u(n,i),u(i,o),u(t,l),u(t,s),a||(c=[z(window,"resize",e[2]),z(n,"click",function(){Fe(e[0]?e[3]:e[4])&&(e[0]?e[3]:e[4]).apply(this,arguments)}),Xe(e[1].call(null,s))],a=!0)},p(f,[m]){e=f,m&1&&r!==(r=e[0]?"close":"add")&&g(o,"name",r)},i:I,o:I,d(f){f&&v(t),a=!1,ge(c)}}}function St(e,t,n){let i,o;G(e,se,d=>n(0,i=d)),G(e,q,d=>n(8,o=d));let r=null,l=null,s=null;const a=async()=>{const d=await je.getCurrentPosition();return{lat:d.coords.latitude,lng:d.coords.longitude}},c=d=>(r=Q.map(d,{preferCanvas:!0}),Q.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xA9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:20,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoicmVkNWg0ZDB3IiwiYSI6ImNrems4bzhzMzRrcG4yeHByYTgwN2draHcifQ.356a0A2cfoy3zrhq-IW_rA"}).addTo(r),r.setView([45.508888,-73.561668],14),{destroy:()=>{r==null||r.remove(),r=null}}),f=()=>r==null?void 0:r.invalidateSize(),m=async d=>{!r||(s==null||s.removeFrom(r),l==null||l.removeFrom(r),s=Q.circleMarker(d,{color:"red",weight:2,opacity:.7}),l=Q.polyline([d],{color:"red",weight:3,opacity:.5,smoothFactor:1}),s.addTo(r),l.addTo(r))},w=()=>{if(!r||!(i==null?void 0:i.geopoints.length))return;const d=i.geopoints.sort((T,b)=>T.timestamp<b.timestamp?-1:1).map(T=>[T.location.latitude,T.location.longitude]);s=Q.circleMarker(d[d.length-1],{color:"red",weight:2,opacity:.7}),l=Q.polyline(d,{color:"red",weight:3,opacity:.5,smoothFactor:1}),s.addTo(r),l.addTo(r)},_=()=>{if(!i)return;const d=be(i.geopoints.map(b=>b.location)),T={id:i.id,userEmail:i.userEmail,transportType:i.transportType,startTime:new Date(i.startTime),endTime:new Date,distance:d,geopoints:i.geopoints.map(({location:b,timestamp:U})=>({location:b,timestamp:new Date(U)}))};ne.updateTrip(T),se.set(null),r&&(l==null||l.removeFrom(r),s==null||s.removeFrom(r)),q.update(b=>b?(b.credits+=Math.floor(5*d/1e3),b):null)},h=async()=>{se.set({id:Date.now().toString(),userEmail:o.email,startTime:new Date().toISOString(),transportType:"velo",geopoints:[]});const d=await a();m(d)};return ye(()=>{setInterval(async()=>{const d=await a();!i||(mt({latitude:d.lat,longitude:d.lng}),i.geopoints.length==0?m(d):l==null||l.addLatLng(d))},3e3),setTimeout(async()=>{const d=await a();r==null||r.setView(d),(i==null?void 0:i.geopoints.length)&&w(),f()},300)}),[i,c,f,_,h]}class Rt extends B{constructor(t){super();K(this,t,St,Tt,V,{})}}function Ut(e){let t,n,i,o=e[0].name+"",r,l,s,a=e[0].description+"",c,f,m,w,_=e[0].price+"",h,d,T,b,U=e[0].expiration?`Expires on ${e[0].expiration.toDateString()}`:"",A,y,C,O;return{c(){t=p("ion-card"),n=p("ion-card-header"),i=p("ion-card-title"),r=D(o),l=S(),s=p("ion-card-subtitle"),c=D(a),f=S(),m=p("ion-card-content"),w=D("Cost: "),h=D(_),d=D(` credits.\r
        `),T=p("br"),b=S(),A=D(U),g(s,"class","sub svelte-aab9bb"),g(m,"class","content svelte-aab9bb"),g(t,"class",y=Re(e[1]?"redeemed":"notRedeemed")+" svelte-aab9bb")},m(E,H){k(E,t,H),u(t,n),u(n,i),u(i,r),u(n,l),u(n,s),u(s,c),u(t,f),u(t,m),u(m,w),u(m,h),u(m,d),u(m,T),u(m,b),u(m,A),C||(O=z(t,"click",e[2]),C=!0)},p(E,[H]){H&1&&o!==(o=E[0].name+"")&&W(r,o),H&1&&a!==(a=E[0].description+"")&&W(c,a),H&1&&_!==(_=E[0].price+"")&&W(h,_),H&1&&U!==(U=E[0].expiration?`Expires on ${E[0].expiration.toDateString()}`:"")&&W(A,U),H&2&&y!==(y=Re(E[1]?"redeemed":"notRedeemed")+" svelte-aab9bb")&&g(t,"class",y)},i:I,o:I,d(E){E&&v(t),C=!1,O()}}}function Ct(e,t,n){let i;G(e,q,s=>n(3,i=s));let{reward:o}=t,{isRedeemed:r=!1}=t;function l(){!r||!o.remainingUnits||i.credits<o.price||(n(1,r=!0),i&&(X(q,i.credits-=o.price,i),n(0,o.remainingUnits--,o)))}return r=!0,q.update(s=>s?(s.credits-=o.price,s):null),e.$$set=s=>{"reward"in s&&n(0,o=s.reward),"isRedeemed"in s&&n(1,r=s.isRedeemed)},[o,r,l]}class It extends B{constructor(t){super();K(this,t,Ct,Ut,V,{reward:0,isRedeemed:1})}}function Le(e,t,n){const i=e.slice();return i[3]=t[n],i}function De(e){let t,n,i=e[1],o=[];for(let l=0;l<i.length;l+=1)o[l]=Ee(Le(e,i,l));const r=l=>L(o[l],1,1,()=>{o[l]=null});return{c(){for(let l=0;l<o.length;l+=1)o[l].c();t=ce()},m(l,s){for(let a=0;a<o.length;a+=1)o[a].m(l,s);k(l,t,s),n=!0},p(l,s){if(s&2){i=l[1];let a;for(a=0;a<i.length;a+=1){const c=Le(l,i,a);o[a]?(o[a].p(c,s),R(o[a],1)):(o[a]=Ee(c),o[a].c(),R(o[a],1),o[a].m(t.parentNode,t))}for(j(),a=i.length;a<o.length;a+=1)r(a);x()}},i(l){if(!n){for(let s=0;s<i.length;s+=1)R(o[s]);n=!0}},o(l){o=o.filter(Boolean);for(let s=0;s<o.length;s+=1)L(o[s]);n=!1},d(l){xe(o,l),l&&v(t)}}}function Ee(e){let t,n;return t=new It({props:{reward:e[3]}}),{c(){J(t.$$.fragment)},m(i,o){Y(t,i,o),n=!0},p(i,o){const r={};o&2&&(r.reward=i[3]),t.$set(r)},i(i){n||(R(t.$$.fragment,i),n=!0)},o(i){L(t.$$.fragment,i),n=!1},d(i){Z(t,i)}}}function Lt(e){var h;let t,n,i,o,r,l,s=((h=e[0])==null?void 0:h.credits)+"",a,c,f,m,w,_=e[1]&&De(e);return{c(){t=p("ion-header"),n=p("ion-toolbar"),i=p("ion-title"),i.textContent="Rewards",o=S(),r=p("ion-subtitle"),l=D("You have "),a=D(s),c=D(" points to spend."),f=S(),m=p("ion-content"),_&&_.c(),g(t,"translucent","")},m(d,T){k(d,t,T),u(t,n),u(n,i),u(n,o),u(n,r),u(r,l),u(r,a),u(r,c),k(d,f,T),k(d,m,T),_&&_.m(m,null),w=!0},p(d,[T]){var b;(!w||T&1)&&s!==(s=((b=d[0])==null?void 0:b.credits)+"")&&W(a,s),d[1]?_?(_.p(d,T),T&2&&R(_,1)):(_=De(d),_.c(),R(_,1),_.m(m,null)):_&&(j(),L(_,1,1,()=>{_=null}),x())},i(d){w||(R(_),w=!0)},o(d){L(_),w=!1},d(d){d&&v(t),d&&v(f),d&&v(m),_&&_.d()}}}function Dt(e,t,n){let i,o;return G(e,q,r=>n(0,i=r)),G(e,_e,r=>n(1,o=r)),q.subscribe(r=>{}),[i,o]}class Et extends B{constructor(t){super();K(this,t,Dt,Lt,V,{})}}function $t(e){let t,n,i,o,r,l,s,a;return{c(){t=p("ion-list"),n=p("ion-item"),n.innerHTML=`Logout
        <ion-icon name="log-out-outline" slot="end"></ion-icon>`,i=S(),o=p("ion-item"),o.innerHTML=`about
        <ion-icon name="information-circle-outline" slot="end"></ion-icon>`,r=S(),l=p("ion-item"),l.innerHTML=`GitHub Repo
        <ion-icon name="logo-github" slot="end"></ion-icon>`,g(n,"button",""),g(o,"button",""),g(l,"lines","none"),g(l,"button",""),g(t,"lines","n")},m(c,f){k(c,t,f),u(t,n),u(t,i),u(t,o),u(t,r),u(t,l),s||(a=[z(n,"click",e[1]),z(o,"click",e[2]),z(l,"click",e[3])],s=!0)},p:I,i:I,o:I,d(c){c&&v(t),s=!1,ge(a)}}}function Mt(e){let t=document.querySelector("ion-popover");const n=l=>{t.dismiss(l)};return[n,()=>{n("logout")},()=>{n("about")},()=>{n("github")}]}class Nt extends B{constructor(t){super();K(this,t,Mt,$t,V,{})}}const Pt=function(e){return document.createElement(e).constructor!==HTMLElement},Ft=(e,t)=>{Pt(e)||tt(e,t,[])},zt=(e,t,n,i)=>(Ft(t,n),et.create({component:t,event:e,componentProps:i}).then(o=>(o.present(),o.onWillDismiss()))),Ot=()=>!!ee().currentUser,Ht=()=>{var e;return((e=ee().currentUser)==null?void 0:e.email)||null},Wt=async(e,t)=>{try{return await nt(ee(),e,t),!0}catch(n){return console.log("Failed to login"),console.log(n),!1}},qt=()=>ee().signOut(),At=async(e,t,n)=>{try{return await it(ee(),t,n),await ne.updateUser({email:t,name:e,credits:0,redeemedRewards:[],trips:[]}),!0}catch(i){return console.log("Failed to sign up"),console.log(i),!1}};var ie={logout:qt,login:Wt,getCurrentUser:Ht,isLoggedIn:Ot,signUp:At};function Gt(e){let t,n,i,o,r,l=be(e[0].geopoints)+"",s;return{c(){t=p("ion-item"),n=p("ion-icon"),o=S(),r=p("ion-label"),s=D(l),g(n,"name",i=$e(e[0].transportType)),g(n,"slot","start")},m(a,c){k(a,t,c),u(t,n),u(t,o),u(t,r),u(r,s)},p(a,[c]){c&1&&i!==(i=$e(a[0].transportType))&&g(n,"name",i),c&1&&l!==(l=be(a[0].geopoints)+"")&&W(s,l)},i:I,o:I,d(a){a&&v(t)}}}function $e(e){switch(e){case"bicycle":return"bicycle";case"walk":return"walk";case"public_transport":return"bus";default:return"walk"}}function Bt(e,t,n){let{trip:i}=t;return e.$$set=o=>{"trip"in o&&n(0,i=o.trip)},[i]}class Kt extends B{constructor(t){super();K(this,t,Bt,Gt,V,{trip:0})}}function Me(e,t,n){const i=e.slice();return i[3]=t[n],i}function Vt(e){let t,n,i,o,r,l;return{c(){t=p("ion-item"),n=p("ion-label"),n.textContent="Failed to load user",i=S(),o=p("ion-button"),o.textContent="Go back to login page",g(o,"slot","end"),g(o,"fill","outline")},m(s,a){k(s,t,a),u(t,n),u(t,i),u(t,o),r||(l=z(o,"click",e[2]),r=!0)},p:I,i:I,o:I,d(s){s&&v(t),r=!1,l()}}}function Jt(e){let t,n,i=[],o=new Map,r,l,s=e[0].trips;const a=c=>c[3].id;for(let c=0;c<s.length;c+=1){let f=Me(e,s,c),m=a(f);o.set(m,i[c]=Ne(m,f))}return{c(){t=p("ion-list-header"),t.innerHTML="<ion-label>Trips</ion-label>",n=S();for(let c=0;c<i.length;c+=1)i[c].c();r=ce()},m(c,f){k(c,t,f),k(c,n,f);for(let m=0;m<i.length;m+=1)i[m].m(c,f);k(c,r,f),l=!0},p(c,f){f&1&&(s=c[0].trips,j(),i=ot(i,f,a,1,c,s,o,r.parentNode,rt,Ne,r,Me),x())},i(c){if(!l){for(let f=0;f<s.length;f+=1)R(i[f]);l=!0}},o(c){for(let f=0;f<i.length;f+=1)L(i[f]);l=!1},d(c){c&&v(t),c&&v(n);for(let f=0;f<i.length;f+=1)i[f].d(c);c&&v(r)}}}function Ne(e,t){let n,i,o;return i=new Kt({props:{trip:t[3]}}),{key:e,first:null,c(){n=ce(),J(i.$$.fragment),this.first=n},m(r,l){k(r,n,l),Y(i,r,l),o=!0},p(r,l){t=r;const s={};l&1&&(s.trip=t[3]),i.$set(s)},i(r){o||(R(i.$$.fragment,r),o=!0)},o(r){L(i.$$.fragment,r),o=!1},d(r){r&&v(n),Z(i,r)}}}function Yt(e){let t,n,i,o,r,l,s=(e[0]?e[0].name:"Profile")+"",a,c,f,m,w,_,h,d,T;const b=[Jt,Vt],U=[];function A(y,C){return y[0]?0:1}return w=A(e),_=U[w]=b[w](e),{c(){t=p("ion-header"),n=p("ion-toolbar"),i=p("ion-buttons"),o=p("ion-button"),o.innerHTML='<ion-icon slot="icon-only" ios="ellipsis-horizontal" md="ellipsis-vertical"></ion-icon>',r=S(),l=p("ion-title"),a=D(s),c=S(),f=p("ion-content"),m=p("ion-list"),_.c(),g(i,"slot","primary"),g(t,"translucent","")},m(y,C){k(y,t,C),u(t,n),u(n,i),u(i,o),u(n,r),u(n,l),u(l,a),k(y,c,C),k(y,f,C),u(f,m),U[w].m(m,null),h=!0,d||(T=z(o,"click",e[1]),d=!0)},p(y,[C]){(!h||C&1)&&s!==(s=(y[0]?y[0].name:"Profile")+"")&&W(a,s);let O=w;w=A(y),w===O?U[w].p(y,C):(j(),L(U[O],1,1,()=>{U[O]=null}),x(),_=U[w],_?_.p(y,C):(_=U[w]=b[w](y),_.c()),R(_,1),_.m(m,null))},i(y){h||(R(_),h=!0)},o(y){L(_),h=!1},d(y){y&&v(t),y&&v(c),y&&v(f),U[w].d(),d=!1,T()}}}function Zt(e,t,n){let i;G(e,q,l=>n(0,i=l));function o(l){zt(l,"popover-extra",Nt,{}).then(async s=>{s.data=="logout"&&await ie.logout()})}return[i,o,()=>ie.logout()]}class Qt extends B{constructor(t){super();K(this,t,Zt,Yt,V,{})}}function Xt(e){let t,n,i,o,r,l,s,a,c,f,m,w,_;return o=new Rt({}),s=new Et({}),f=new Qt({}),{c(){t=p("ion-app"),n=p("ion-tabs"),i=p("ion-tab"),J(o.$$.fragment),r=S(),l=p("ion-tab"),J(s.$$.fragment),a=S(),c=p("ion-tab"),J(f.$$.fragment),m=S(),w=p("ion-tab-bar"),w.innerHTML=`<ion-tab-button tab="map"><ion-label>Map</ion-label> 
        <ion-icon name="bicycle-outline"></ion-icon></ion-tab-button> 
      <ion-tab-button tab="rewards"><ion-label>Rewards</ion-label> 
        <ion-icon name="trophy-outline"></ion-icon></ion-tab-button> 
      <ion-tab-button tab="profile"><ion-label>profile</ion-label> 
        <ion-icon name="analytics-outline"></ion-icon></ion-tab-button>`,g(i,"tab","map"),g(l,"tab","rewards"),g(c,"tab","profile"),g(w,"slot","bottom")},m(h,d){k(h,t,d),u(t,n),u(n,i),Y(o,i,null),u(n,r),u(n,l),Y(s,l,null),u(n,a),u(n,c),Y(f,c,null),u(n,m),u(n,w),_=!0},p:I,i(h){_||(R(o.$$.fragment,h),R(s.$$.fragment,h),R(f.$$.fragment,h),_=!0)},o(h){L(o.$$.fragment,h),L(s.$$.fragment,h),L(f.$$.fragment,h),_=!1},d(h){h&&v(t),Z(o),Z(s),Z(f)}}}function jt(e,t,n){let i,o;return G(e,_e,r=>n(0,i=r)),G(e,q,r=>n(1,o=r)),ye(async()=>{const r=await ne.fetchUser(ie.getCurrentUser());X(q,o=r,o);const l=await ne.fetchAllRewards();X(_e,i=l,i)}),q.subscribe(async r=>{r&&await ne.updateUser(r)}),[]}class xt extends B{constructor(t){super();K(this,t,jt,Xt,V,{})}}function Pe(e){let t,n,i,o;const r=[tn,en],l=[];function s(a,c){return a[3]?1:0}return t=s(e),n=l[t]=r[t](e),{c(){n.c(),i=ce()},m(a,c){l[t].m(a,c),k(a,i,c),o=!0},p(a,c){let f=t;t=s(a),t===f?l[t].p(a,c):(j(),L(l[f],1,1,()=>{l[f]=null}),x(),n=l[t],n?n.p(a,c):(n=l[t]=r[t](a),n.c()),R(n,1),n.m(i.parentNode,i))},i(a){o||(R(n),o=!0)},o(a){L(n),o=!1},d(a){l[t].d(a),a&&v(i)}}}function en(e){let t,n;return t=new xt({}),{c(){J(t.$$.fragment)},m(i,o){Y(t,i,o),n=!0},p:I,i(i){n||(R(t.$$.fragment,i),n=!0)},o(i){L(t.$$.fragment,i),n=!1},d(i){Z(t,i)}}}function tn(e){let t,n,i;function o(l){e[5](l)}let r={errorNote:e[2]};return e[1]!==void 0&&(r.signup=e[1]),t=new dt({props:r}),te.push(()=>lt(t,"signup",o)),t.$on("submit",e[4]),{c(){J(t.$$.fragment)},m(l,s){Y(t,l,s),i=!0},p(l,s){const a={};s&4&&(a.errorNote=l[2]),!n&&s&2&&(n=!0,a.signup=l[1],st(()=>n=!1)),t.$set(a)},i(l){i||(R(t.$$.fragment,l),i=!0)},o(l){L(t.$$.fragment,l),i=!1},d(l){Z(t,l)}}}function nn(e){let t,n,i=e[0]&&Pe(e);return{c(){t=p("ion-app"),i&&i.c()},m(o,r){k(o,t,r),i&&i.m(t,null),n=!0},p(o,[r]){o[0]?i?(i.p(o,r),r&1&&R(i,1)):(i=Pe(o),i.c(),R(i,1),i.m(t,null)):i&&(j(),L(i,1,1,()=>{i=null}),x())},i(o){n||(R(i),n=!0)},o(o){L(i),n=!1},d(o){o&&v(t),i&&i.d()}}}function on(e,t,n,i,o){return o&&n!==i?"Passwords do not match":""}function rn(e,t,n){let i;G(e,le,c=>n(3,i=c)),ye(()=>{at({apiKey:"AIzaSyClWb9snAaau0p3gWecoCVMywUwIKgP7Eo",authDomain:"hackatown-2022.firebaseapp.com",projectId:"hackatown-2022",storageBucket:"hackatown-2022.appspot.com",messagingSenderId:"410454368204",appId:"1:410454368204:web:16fa9750c1621761564769"}),ee().onAuthStateChanged(c=>{X(le,i=!!c,i),n(0,o=!0)})});let o=!1,r=!1,l="";async function s(c){const{name:f,email:m,password:w,confirmPassword:_,signup:h}=c.detail,d=on(f,m,w,_,h);if(d!=""){n(2,l=d);return}h?await ie.signUp(f,m,w)?(n(2,l=""),X(le,i=!0,i)):n(2,l="Signup failed"):await ie.login(m,w)?(n(2,l=""),X(le,i=!0,i)):n(2,l="Invalid email or password")}function a(c){r=c,n(1,r)}return[o,r,l,i,s,a]}class ln extends B{constructor(t){super();K(this,t,rn,nn,V,{})}}new ln({target:document.body});

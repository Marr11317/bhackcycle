var Ke=Object.defineProperty,Ve=Object.defineProperties;var Je=Object.getOwnPropertyDescriptors;var re=Object.getOwnPropertySymbols;var Te=Object.prototype.hasOwnProperty,$e=Object.prototype.propertyIsEnumerable;var ve=(t,e,n)=>e in t?Ke(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ue=(t,e)=>{for(var n in e||(e={}))Te.call(e,n)&&ve(t,n,e[n]);if(re)for(var n of re(e))$e.call(e,n)&&ve(t,n,e[n]);return t},fe=(t,e)=>Ve(t,Je(e));var de=(t,e)=>{var n={};for(var i in t)Te.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&re)for(var i of re(t))e.indexOf(i)<0&&$e.call(t,i)&&(n[i]=t[i]);return n};import{S as G,i as K,s as V,e as d,t as D,a as v,b as u,c as q,d as T,f as _,n as C,l as z,g as $,h as Ye,r as ge,j as Ze,k as ee,w as ae,m as Qe,o as pe,p as he,N as we,U as Xe,q as je,u as Oe,D as He,v as xe,x as Re,y as et,z as B,A as ke,B as tt,G as nt,L as Q,C as We,E as Ie,F as ce,H as R,I as J,J as Y,K as U,M as Z,O as X,P as j,Q as it,R as ot,T as x,V as rt,W as lt,X as st,Y as at,Z as te,_ as ct,$ as ut,a0 as ft}from"./vendor.e274b491.js";const dt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}};dt();function Se(t){let e,n,i;return{c(){e=d("ion-item"),n=d("ion-label"),i=D(t[1])},m(o,r){v(o,e,r),u(e,n),u(n,i)},p(o,r){r&2&&q(i,o[1])},d(o){o&&T(e)}}}function Le(t){let e,n;return{c(){e=d("ion-item"),n=d("ion-input"),_(n,"placeholder","Full Name"),_(n,"type","text"),_(n,"required","")},m(i,o){v(i,e,o),u(e,n),t[8](n)},p:C,d(i){i&&T(e),t[8](null)}}}function Ce(t){let e,n,i,o;return{c(){e=d("ion-item"),n=d("ion-input"),_(n,"placeholder","confirm password"),_(n,"type","password"),_(n,"required","")},m(r,l){v(r,e,l),u(e,n),t[11](n),i||(o=z(n,"keypress",t[7]),i=!0)},p:C,d(r){r&&T(e),t[11](null),i=!1,o()}}}function pt(t){let e,n,i,o=t[0]?"Sign up":"Login",r,l,s,c,a,f,m,w,p,h,k,I,y,b=t[0]?"Sign up":"Login",L,g,S,H=t[0]?"Login instead":"Sign up instead",E,W,ye,M=t[1]!==""&&Se(t),N=t[0]&&Le(t),P=t[0]&&Ce(t);return{c(){e=d("ion-header"),n=d("ion-toolbar"),i=d("ion-title"),r=D(o),l=$(),s=d("ion-list"),M&&M.c(),c=$(),N&&N.c(),a=$(),f=d("ion-item"),m=d("ion-input"),w=$(),p=d("ion-item"),h=d("ion-input"),k=$(),P&&P.c(),I=$(),y=d("ion-button"),L=D(b),g=$(),S=d("ion-button"),E=D(H),_(e,"translucent",""),_(m,"placeholder","email"),_(m,"type","text"),_(m,"required",""),_(m,"autofocus",""),_(h,"placeholder","password"),_(h,"type","password"),_(h,"required",""),_(y,"expand","block"),_(s,"lines","full")},m(F,O){v(F,e,O),u(e,n),u(n,i),u(i,r),v(F,l,O),v(F,s,O),M&&M.m(s,null),u(s,c),N&&N.m(s,null),u(s,a),u(s,f),u(f,m),t[9](m),u(s,w),u(s,p),u(p,h),t[10](h),u(s,k),P&&P.m(s,null),u(s,I),u(s,y),u(y,L),v(F,g,O),v(F,S,O),u(S,E),m.focus(),W||(ye=[z(h,"keypress",function(){Ye(t[0]?void 0:t[7])&&(t[0]?void 0:t[7]).apply(this,arguments)}),z(y,"click",t[6]),z(S,"click",t[12])],W=!0)},p(F,[O]){t=F,O&1&&o!==(o=t[0]?"Sign up":"Login")&&q(r,o),t[1]!==""?M?M.p(t,O):(M=Se(t),M.c(),M.m(s,c)):M&&(M.d(1),M=null),t[0]?N?N.p(t,O):(N=Le(t),N.c(),N.m(s,a)):N&&(N.d(1),N=null),t[0]?P?P.p(t,O):(P=Ce(t),P.c(),P.m(s,I)):P&&(P.d(1),P=null),O&1&&b!==(b=t[0]?"Sign up":"Login")&&q(L,b),O&1&&H!==(H=t[0]?"Login instead":"Sign up instead")&&q(E,H)},i:C,o:C,d(F){F&&T(e),F&&T(l),F&&T(s),M&&M.d(),N&&N.d(),t[9](null),t[10](null),P&&P.d(),F&&T(g),F&&T(S),W=!1,ge(ye)}}}function mt(t,e,n){const i=Ze();function o(){!c||!a||r&&!f||i("submit",{name:s?s.value:void 0,email:c.value,password:a.value,confirmPassword:f?f.value:void 0,signup:r})}let{signup:r=!1}=e,{errorNote:l=""}=e,s,c,a,f;function m(y){y.key==="Enter"&&o()}function w(y){ee[y?"unshift":"push"](()=>{s=y,n(2,s)})}function p(y){ee[y?"unshift":"push"](()=>{c=y,n(3,c)})}function h(y){ee[y?"unshift":"push"](()=>{a=y,n(4,a)})}function k(y){ee[y?"unshift":"push"](()=>{f=y,n(5,f)})}const I=()=>n(0,r=!r);return t.$$set=y=>{"signup"in y&&n(0,r=y.signup),"errorNote"in y&&n(1,l=y.errorNote)},[r,l,s,c,a,f,o,m,w,p,h,k,I]}class _t extends G{constructor(e){super();K(this,e,mt,pt,V,{signup:0,errorNote:1})}}const bt=(t,e)=>{const n=localStorage.getItem(t),i=ae(n?JSON.parse(n):e);return i.subscribe(o=>localStorage.setItem(t,o?JSON.stringify(o):"")),i},le=ae(!1),A=ae(null),me=ae(null),se=bt("currentTrip",null),gt=t=>{se.update(e=>e?(e.geopoints=[...e.geopoints,{timestamp:new Date().toISOString(),location:t}],e):null)},_e=t=>{if(!t.length)return 0;let e=0;for(let n=1;n<t.length-1;++n)e+=Qe(t[n-1].location,t[n].location);return e},ht={toFirestore:t=>({name:t.name,email:t.email,credits:t.credits,redeemedRewards:t.redeemedRewards}),fromFirestore:(t,e)=>{const n=t.data(e);return{name:n.name,email:n.email,credits:n.credits,redeemedRewards:n.redeemedRewards}}},qe={toFirestore:t=>({id:t.id,userEmail:t.userEmail,startTime:pe.fromDate(t.startTime),endTime:t.endTime?pe.fromDate(t.endTime):null,transportType:t.transportType,distance:t.distance,geopoints:t.geopoints}),fromFirestore:(t,e)=>{const n=t.data(e);return{id:n.id,userEmail:n.userEmail,startTime:n.startTime.toDate(),endTime:n.endTime?n.endTime.toDate():null,transportType:n.transportType,distance:n.distance,geopoints:n.geopoints}}},Ae={toFirestore:t=>({id:t.id,name:t.name,description:t.description,price:t.price,provider:t.provider,expiration:pe.fromDate(t.expiration),remainingUnits:t.remainingUnits}),fromFirestore:(t,e)=>{const n=t.data(e);return{id:n.id,name:n.name,description:n.description,price:n.price,provider:n.provider,expiration:n.expiration.toDate(),remainingUnits:n.remainingUnits}}},oe=()=>Xe(),Be=t=>we(oe(),"users",t).withConverter(ht),wt=t=>we(oe(),"trips",t.id).withConverter(qe),kt=t=>we(oe(),"rewards",t.id).withConverter(Ae),yt=async t=>{const o=t,{redeemedRewards:e}=o,n=de(o,["redeemedRewards"]),i=fe(ue({},n),{redeemedRewards:e.map(r=>r.id)});await he(Be(t.email),i)},vt=async t=>{await he(wt(t),t)},Tt=async t=>{await he(kt(t),t)},$t=async t=>{const e=await je(Be(t));if(!e.exists())return null;const n=e.data(),s=n,{redeemedRewards:i}=s,o=de(s,["redeemedRewards"]),r=await Rt(n.email),l=(await Ge()).filter(c=>(i||[]).includes(c.id));return fe(ue({},o),{trips:r,redeemedRewards:l})},Rt=async t=>{const e=[];return(await Oe(He(oe(),"trips").withConverter(qe))).forEach(i=>i.exists()&&e.push(i.data())),e.filter(i=>i.userEmail===t)},Ge=async()=>{const t=[];return(await Oe(He(oe(),"rewards").withConverter(Ae))).forEach(n=>n.exists()&&t.push(n.data())),t};var ne={fetchUser:$t,fetchAllRewards:Ge,updateUser:yt,updateTrip:vt,updateReward:Tt};function be(t){switch(t){case"bicycle":return"bicycle";case"walk":return"walk";case"publicTransport":return"bus";default:return"walk"}}const{window:It}=tt;function Ue(t,e,n){const i=t.slice();return i[15]=e[n],i}function St(t){let e,n,i,o,r=t[5],l=[];for(let s=0;s<r.length;s+=1)l[s]=De(Ue(t,r,s));return{c(){e=d("ion-fab"),n=d("ion-fab-button"),n.innerHTML='<ion-icon name="add"></ion-icon>',i=$(),o=d("ion-fab-list");for(let s=0;s<l.length;s+=1)l[s].c();_(o,"side","top"),_(e,"horizontal","center"),_(e,"vertical","bottom"),_(e,"slot","fixed")},m(s,c){v(s,e,c),u(e,n),u(e,i),u(e,o);for(let a=0;a<l.length;a+=1)l[a].m(o,null)},p(s,c){if(c&48){r=s[5];let a;for(a=0;a<r.length;a+=1){const f=Ue(s,r,a);l[a]?l[a].p(f,c):(l[a]=De(f),l[a].c(),l[a].m(o,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=r.length}},d(s){s&&T(e),We(l,s)}}}function Lt(t){let e,n,i;return{c(){e=d("ion-fab"),e.innerHTML='<ion-fab-button><ion-icon name="close"></ion-icon></ion-fab-button>',_(e,"horizontal","center"),_(e,"vertical","bottom"),_(e,"slot","fixed")},m(o,r){v(o,e,r),n||(i=z(e,"click",t[3]),n=!0)},p:C,d(o){o&&T(e),n=!1,i()}}}function De(t){let e,n,i,o,r,l;function s(){return t[6](t[15])}return{c(){e=d("ion-fab-button"),n=d("ion-icon"),o=$(),_(n,"name",i=be(t[15]))},m(c,a){v(c,e,a),u(e,n),u(e,o),r||(l=z(e,"click",s),r=!0)},p(c,a){t=c},d(c){c&&T(e),r=!1,l()}}}function Ct(t){let e,n,i,o,r;function l(a,f){return a[0]?Lt:St}let s=l(t),c=s(t);return{c(){e=d("ion-content"),c.c(),n=$(),i=d("div"),xe(i,"class","map svelte-vsoji2"),Re(i,"height","100%"),Re(i,"width","100%")},m(a,f){v(a,e,f),c.m(e,null),u(e,n),u(e,i),o||(r=[z(It,"resize",t[2]),et(t[1].call(null,i))],o=!0)},p(a,[f]){s===(s=l(a))&&c?c.p(a,f):(c.d(1),c=s(a),c&&(c.c(),c.m(e,n)))},i:C,o:C,d(a){a&&T(e),c.d(),o=!1,ge(r)}}}function Ut(t,e,n){let i,o;B(t,se,b=>n(0,i=b)),B(t,A,b=>n(11,o=b));let r=null,l=null,s=null;const c=async()=>{const b=await nt.getCurrentPosition();return{lat:b.coords.latitude,lng:b.coords.longitude}},a=b=>(r=Q.map(b,{preferCanvas:!0}),Q.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xA9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:20,minZoom:1,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoicmVkNWg0ZDB3IiwiYSI6ImNrems4bzhzMzRrcG4yeHByYTgwN2draHcifQ.356a0A2cfoy3zrhq-IW_rA"}).addTo(r),r.setView([45.504755,-73.612572],14),{destroy:()=>{r==null||r.remove(),r=null}}),f=()=>r==null?void 0:r.invalidateSize(),m=async b=>{!r||(s==null||s.removeFrom(r),l==null||l.removeFrom(r),s=Q.circleMarker(b,{color:"red",weight:2,opacity:.7}),l=Q.polyline([b],{color:"red",weight:3,opacity:.5,smoothFactor:1}),s.addTo(r),l.addTo(r))},w=()=>{if(!r||!(i==null?void 0:i.geopoints.length))return;const b=i.geopoints.sort((L,g)=>L.timestamp<g.timestamp?-1:1).map(L=>[L.location.latitude,L.location.longitude]);s=Q.circleMarker(b[b.length-1],{color:"red",weight:2,opacity:.7}),l=Q.polyline(b,{color:"red",weight:3,opacity:.5,smoothFactor:1}),s.addTo(r),l.addTo(r)};let p=null;const h=()=>{if(p&&(clearInterval(p),p=null),!i)return;const b=_e(i.geopoints),L={id:i.id,userEmail:i.userEmail,transportType:i.transportType,startTime:new Date(i.startTime),endTime:new Date,distance:b,geopoints:i.geopoints.map(({location:g,timestamp:S})=>({location:g,timestamp:S}))};ne.updateTrip(L),se.set(null),r&&(l==null||l.removeFrom(r),s==null||s.removeFrom(r)),A.update(g=>g?(g.credits+=Math.floor(5*b/1e3),g):null)},k=async b=>{se.set({id:Date.now().toString(),userEmail:o.email,startTime:new Date().toISOString(),transportType:b,geopoints:[]});const L=await c();m(L),p=window.setInterval(async()=>{if(!i)return;const g=await c();gt({latitude:g.lat,longitude:g.lng}),i.geopoints.length==0?m(g):l==null||l.addLatLng(g)},3e3)};return ke(()=>{setTimeout(async()=>{const b=await c();r==null||r.setView(b),(i==null?void 0:i.geopoints.length)&&w(),f()},300)}),[i,a,f,h,k,["publicTransport","walk","bicycle"],b=>k(b)]}class Dt extends G{constructor(e){super();K(this,e,Ut,Ct,V,{})}}function Et(t){let e,n,i,o=t[0].name+"",r,l,s,c=t[0].description+"",a,f,m,w,p=t[0].price+"",h,k,I,y,b=t[0].expiration?`Expires on ${t[0].expiration.toDateString()}`:"",L,g,S,H;return{c(){e=d("ion-card"),n=d("ion-card-header"),i=d("ion-card-title"),r=D(o),l=$(),s=d("ion-card-subtitle"),a=D(c),f=$(),m=d("ion-card-content"),w=D("Cost: "),h=D(p),k=D(` credits.\r
        `),I=d("br"),y=$(),L=D(b),_(s,"class","sub svelte-aab9bb"),_(m,"class","content svelte-aab9bb"),_(e,"class",g=Ie(t[1]?"redeemed":"notRedeemed")+" svelte-aab9bb")},m(E,W){v(E,e,W),u(e,n),u(n,i),u(i,r),u(n,l),u(n,s),u(s,a),u(e,f),u(e,m),u(m,w),u(m,h),u(m,k),u(m,I),u(m,y),u(m,L),S||(H=z(e,"click",t[3]),S=!0)},p(E,[W]){W&1&&o!==(o=E[0].name+"")&&q(r,o),W&1&&c!==(c=E[0].description+"")&&q(a,c),W&1&&p!==(p=E[0].price+"")&&q(h,p),W&1&&b!==(b=E[0].expiration?`Expires on ${E[0].expiration.toDateString()}`:"")&&q(L,b),W&2&&g!==(g=Ie(E[1]?"redeemed":"notRedeemed")+" svelte-aab9bb")&&_(e,"class",g)},i:C,o:C,d(E){E&&T(e),S=!1,H()}}}function Mt(t,e,n){let i;B(t,A,a=>n(4,i=a));let{reward:o}=e,r=i.redeemedRewards.findIndex(a=>a.id===o.id)!==-1;function l(){!s()&&o.remainingUnits!==0&&i.credits>=o.price&&(A.update(a=>(n(1,r=!0),a.credits-=o.price,a.redeemedRewards=[...a.redeemedRewards,o],a)),n(0,o.remainingUnits--,o))}function s(){return i.redeemedRewards.findIndex(a=>a.id===o.id)!==-1}const c=()=>l();return t.$$set=a=>{"reward"in a&&n(0,o=a.reward)},[o,r,l,c]}class Nt extends G{constructor(e){super();K(this,e,Mt,Et,V,{reward:0})}}function Ee(t,e,n){const i=t.slice();return i[3]=e[n],i}function Me(t){let e,n,i=t[1],o=[];for(let l=0;l<i.length;l+=1)o[l]=Ne(Ee(t,i,l));const r=l=>U(o[l],1,1,()=>{o[l]=null});return{c(){for(let l=0;l<o.length;l+=1)o[l].c();e=ce()},m(l,s){for(let c=0;c<o.length;c+=1)o[c].m(l,s);v(l,e,s),n=!0},p(l,s){if(s&2){i=l[1];let c;for(c=0;c<i.length;c+=1){const a=Ee(l,i,c);o[c]?(o[c].p(a,s),R(o[c],1)):(o[c]=Ne(a),o[c].c(),R(o[c],1),o[c].m(e.parentNode,e))}for(X(),c=i.length;c<o.length;c+=1)r(c);j()}},i(l){if(!n){for(let s=0;s<i.length;s+=1)R(o[s]);n=!0}},o(l){o=o.filter(Boolean);for(let s=0;s<o.length;s+=1)U(o[s]);n=!1},d(l){We(o,l),l&&T(e)}}}function Ne(t){let e,n;return e=new Nt({props:{reward:t[3]}}),{c(){J(e.$$.fragment)},m(i,o){Y(e,i,o),n=!0},p(i,o){const r={};o&2&&(r.reward=i[3]),e.$set(r)},i(i){n||(R(e.$$.fragment,i),n=!0)},o(i){U(e.$$.fragment,i),n=!1},d(i){Z(e,i)}}}function Pt(t){var h;let e,n,i,o,r,l,s=((h=t[0])==null?void 0:h.credits)+"",c,a,f,m,w,p=t[1]&&Me(t);return{c(){e=d("ion-header"),n=d("ion-toolbar"),i=d("ion-title"),i.textContent="Rewards",o=$(),r=d("ion-subtitle"),l=D("You have "),c=D(s),a=D(" points to spend."),f=$(),m=d("ion-content"),p&&p.c(),_(e,"translucent","")},m(k,I){v(k,e,I),u(e,n),u(n,i),u(n,o),u(n,r),u(r,l),u(r,c),u(r,a),v(k,f,I),v(k,m,I),p&&p.m(m,null),w=!0},p(k,[I]){var y;(!w||I&1)&&s!==(s=((y=k[0])==null?void 0:y.credits)+"")&&q(c,s),k[1]?p?(p.p(k,I),I&2&&R(p,1)):(p=Me(k),p.c(),R(p,1),p.m(m,null)):p&&(X(),U(p,1,1,()=>{p=null}),j())},i(k){w||(R(p),w=!0)},o(k){U(p),w=!1},d(k){k&&T(e),k&&T(f),k&&T(m),p&&p.d()}}}function Ft(t,e,n){let i,o;return B(t,A,r=>n(0,i=r)),B(t,me,r=>n(1,o=r)),A.subscribe(r=>{}),[i,o]}class zt extends G{constructor(e){super();K(this,e,Ft,Pt,V,{})}}function Ot(t){let e,n,i,o,r,l,s,c;return{c(){e=d("ion-list"),n=d("ion-item"),n.innerHTML=`Logout
        <ion-icon name="log-out-outline" slot="end"></ion-icon>`,i=$(),o=d("ion-item"),o.innerHTML=`about
        <ion-icon name="information-circle-outline" slot="end"></ion-icon>`,r=$(),l=d("ion-item"),l.innerHTML=`GitHub Repo
        <ion-icon name="logo-github" slot="end"></ion-icon>`,_(n,"button",""),_(o,"button",""),_(l,"lines","none"),_(l,"button",""),_(e,"lines","n")},m(a,f){v(a,e,f),u(e,n),u(e,i),u(e,o),u(e,r),u(e,l),s||(c=[z(n,"click",t[1]),z(o,"click",t[2]),z(l,"click",t[3])],s=!0)},p:C,i:C,o:C,d(a){a&&T(e),s=!1,ge(c)}}}function Ht(t){let e=document.querySelector("ion-popover");const n=l=>{e==null||e.dismiss(l)};return[n,()=>{n("logout")},()=>{n("about")},()=>{n("github")}]}class Wt extends G{constructor(e){super();K(this,e,Ht,Ot,V,{})}}const qt=function(t){return document.createElement(t).constructor!==HTMLElement},At=(t,e)=>{qt(t)||ot(t,e,[])},Bt=(t,e,n,i)=>(At(e,n),it.create({component:e,event:t,componentProps:i}).then(o=>(o.present(),o.onWillDismiss()))),Gt=()=>!!x().currentUser,Kt=()=>{var t;return((t=x().currentUser)==null?void 0:t.email)||null},Vt=async(t,e)=>{try{return await rt(x(),t,e),!0}catch(n){return console.log("Failed to login"),console.log(n),!1}},Jt=()=>x().signOut(),Yt=async(t,e,n)=>{try{return await lt(x(),e,n),await ne.updateUser({email:e,name:t,credits:100,redeemedRewards:[],trips:[]}),!0}catch(i){return console.log("Failed to sign up"),console.log(i),!1}};var ie={logout:Jt,login:Vt,getCurrentUser:Kt,isLoggedIn:Gt,signUp:Yt};function Zt(t){let e,n,i,o,r,l=_e(t[0].geopoints)+"",s;return{c(){e=d("ion-item"),n=d("ion-icon"),o=$(),r=d("ion-label"),s=D(l),_(n,"name",i=be(t[0].transportType)),_(n,"slot","start")},m(c,a){v(c,e,a),u(e,n),u(e,o),u(e,r),u(r,s)},p(c,[a]){a&1&&i!==(i=be(c[0].transportType))&&_(n,"name",i),a&1&&l!==(l=_e(c[0].geopoints)+"")&&q(s,l)},i:C,o:C,d(c){c&&T(e)}}}function Qt(t,e,n){let{trip:i}=e;return t.$$set=o=>{"trip"in o&&n(0,i=o.trip)},[i]}class Xt extends G{constructor(e){super();K(this,e,Qt,Zt,V,{trip:0})}}function Pe(t,e,n){const i=t.slice();return i[3]=e[n],i}function jt(t){let e,n,i,o,r,l;return{c(){e=d("ion-item"),n=d("ion-label"),n.textContent="Failed to load user",i=$(),o=d("ion-button"),o.textContent="Go back to login page",_(o,"slot","end"),_(o,"fill","outline")},m(s,c){v(s,e,c),u(e,n),u(e,i),u(e,o),r||(l=z(o,"click",t[2]),r=!0)},p:C,i:C,o:C,d(s){s&&T(e),r=!1,l()}}}function xt(t){let e,n,i=[],o=new Map,r,l,s=t[0].trips;const c=a=>a[3].id;for(let a=0;a<s.length;a+=1){let f=Pe(t,s,a),m=c(f);o.set(m,i[a]=Fe(m,f))}return{c(){e=d("ion-list-header"),e.innerHTML="<ion-label>Trips</ion-label>",n=$();for(let a=0;a<i.length;a+=1)i[a].c();r=ce()},m(a,f){v(a,e,f),v(a,n,f);for(let m=0;m<i.length;m+=1)i[m].m(a,f);v(a,r,f),l=!0},p(a,f){f&1&&(s=a[0].trips,X(),i=st(i,f,c,1,a,s,o,r.parentNode,at,Fe,r,Pe),j())},i(a){if(!l){for(let f=0;f<s.length;f+=1)R(i[f]);l=!0}},o(a){for(let f=0;f<i.length;f+=1)U(i[f]);l=!1},d(a){a&&T(e),a&&T(n);for(let f=0;f<i.length;f+=1)i[f].d(a);a&&T(r)}}}function Fe(t,e){let n,i,o;return i=new Xt({props:{trip:e[3]}}),{key:t,first:null,c(){n=ce(),J(i.$$.fragment),this.first=n},m(r,l){v(r,n,l),Y(i,r,l),o=!0},p(r,l){e=r;const s={};l&1&&(s.trip=e[3]),i.$set(s)},i(r){o||(R(i.$$.fragment,r),o=!0)},o(r){U(i.$$.fragment,r),o=!1},d(r){r&&T(n),Z(i,r)}}}function en(t){let e,n,i,o,r,l,s=(t[0]?t[0].name:"Profile")+"",c,a,f,m,w,p,h,k,I;const y=[xt,jt],b=[];function L(g,S){return g[0]?0:1}return w=L(t),p=b[w]=y[w](t),{c(){e=d("ion-header"),n=d("ion-toolbar"),i=d("ion-buttons"),o=d("ion-button"),o.innerHTML='<ion-icon slot="icon-only" ios="ellipsis-horizontal" md="ellipsis-vertical"></ion-icon>',r=$(),l=d("ion-title"),c=D(s),a=$(),f=d("ion-content"),m=d("ion-list"),p.c(),_(i,"slot","primary"),_(e,"translucent","")},m(g,S){v(g,e,S),u(e,n),u(n,i),u(i,o),u(n,r),u(n,l),u(l,c),v(g,a,S),v(g,f,S),u(f,m),b[w].m(m,null),h=!0,k||(I=z(o,"click",t[1]),k=!0)},p(g,[S]){(!h||S&1)&&s!==(s=(g[0]?g[0].name:"Profile")+"")&&q(c,s);let H=w;w=L(g),w===H?b[w].p(g,S):(X(),U(b[H],1,1,()=>{b[H]=null}),j(),p=b[w],p?p.p(g,S):(p=b[w]=y[w](g),p.c()),R(p,1),p.m(m,null))},i(g){h||(R(p),h=!0)},o(g){U(p),h=!1},d(g){g&&T(e),g&&T(a),g&&T(f),b[w].d(),k=!1,I()}}}function tn(t,e,n){let i;B(t,A,l=>n(0,i=l));function o(l){Bt(l,"popover-extra",Wt,{}).then(async s=>{s.data=="logout"&&await ie.logout()})}return[i,o,()=>ie.logout()]}class nn extends G{constructor(e){super();K(this,e,tn,en,V,{})}}function on(t){let e,n,i,o,r,l,s,c,a,f,m,w,p;return o=new Dt({}),s=new zt({}),f=new nn({}),{c(){e=d("ion-app"),n=d("ion-tabs"),i=d("ion-tab"),J(o.$$.fragment),r=$(),l=d("ion-tab"),J(s.$$.fragment),c=$(),a=d("ion-tab"),J(f.$$.fragment),m=$(),w=d("ion-tab-bar"),w.innerHTML=`<ion-tab-button tab="map"><ion-label>Map</ion-label> 
        <ion-icon name="bicycle-outline"></ion-icon></ion-tab-button> 
      <ion-tab-button tab="rewards"><ion-label>Rewards</ion-label> 
        <ion-icon name="trophy-outline"></ion-icon></ion-tab-button> 
      <ion-tab-button tab="profile"><ion-label>profile</ion-label> 
        <ion-icon name="analytics-outline"></ion-icon></ion-tab-button>`,_(i,"tab","map"),_(l,"tab","rewards"),_(a,"tab","profile"),_(w,"slot","bottom")},m(h,k){v(h,e,k),u(e,n),u(n,i),Y(o,i,null),u(n,r),u(n,l),Y(s,l,null),u(n,c),u(n,a),Y(f,a,null),u(n,m),u(n,w),p=!0},p:C,i(h){p||(R(o.$$.fragment,h),R(s.$$.fragment,h),R(f.$$.fragment,h),p=!0)},o(h){U(o.$$.fragment,h),U(s.$$.fragment,h),U(f.$$.fragment,h),p=!1},d(h){h&&T(e),Z(o),Z(s),Z(f)}}}function rn(t,e,n){let i,o;return B(t,me,r=>n(0,i=r)),B(t,A,r=>n(1,o=r)),ke(async()=>{const r=await ne.fetchUser(ie.getCurrentUser());te(A,o=r,o);const l=await ne.fetchAllRewards();te(me,i=l,i)}),A.subscribe(async r=>{r&&await ne.updateUser(r)}),[]}class ln extends G{constructor(e){super();K(this,e,rn,on,V,{})}}function ze(t){let e,n,i,o;const r=[an,sn],l=[];function s(c,a){return c[3]?1:0}return e=s(t),n=l[e]=r[e](t),{c(){n.c(),i=ce()},m(c,a){l[e].m(c,a),v(c,i,a),o=!0},p(c,a){let f=e;e=s(c),e===f?l[e].p(c,a):(X(),U(l[f],1,1,()=>{l[f]=null}),j(),n=l[e],n?n.p(c,a):(n=l[e]=r[e](c),n.c()),R(n,1),n.m(i.parentNode,i))},i(c){o||(R(n),o=!0)},o(c){U(n),o=!1},d(c){l[e].d(c),c&&T(i)}}}function sn(t){let e,n;return e=new ln({}),{c(){J(e.$$.fragment)},m(i,o){Y(e,i,o),n=!0},p:C,i(i){n||(R(e.$$.fragment,i),n=!0)},o(i){U(e.$$.fragment,i),n=!1},d(i){Z(e,i)}}}function an(t){let e,n,i;function o(l){t[5](l)}let r={errorNote:t[2]};return t[1]!==void 0&&(r.signup=t[1]),e=new _t({props:r}),ee.push(()=>ct(e,"signup",o)),e.$on("submit",t[4]),{c(){J(e.$$.fragment)},m(l,s){Y(e,l,s),i=!0},p(l,s){const c={};s&4&&(c.errorNote=l[2]),!n&&s&2&&(n=!0,c.signup=l[1],ut(()=>n=!1)),e.$set(c)},i(l){i||(R(e.$$.fragment,l),i=!0)},o(l){U(e.$$.fragment,l),i=!1},d(l){Z(e,l)}}}function cn(t){let e,n,i=t[0]&&ze(t);return{c(){e=d("ion-app"),i&&i.c()},m(o,r){v(o,e,r),i&&i.m(e,null),n=!0},p(o,[r]){o[0]?i?(i.p(o,r),r&1&&R(i,1)):(i=ze(o),i.c(),R(i,1),i.m(e,null)):i&&(X(),U(i,1,1,()=>{i=null}),j())},i(o){n||(R(i),n=!0)},o(o){U(i),n=!1},d(o){o&&T(e),i&&i.d()}}}function un(t,e,n,i,o){return o&&n!==i?"Passwords do not match":""}function fn(t,e,n){let i;B(t,le,a=>n(3,i=a)),ke(()=>{ft({apiKey:"AIzaSyClWb9snAaau0p3gWecoCVMywUwIKgP7Eo",authDomain:"hackatown-2022.firebaseapp.com",projectId:"hackatown-2022",storageBucket:"hackatown-2022.appspot.com",messagingSenderId:"410454368204",appId:"1:410454368204:web:16fa9750c1621761564769"}),x().onAuthStateChanged(a=>{te(le,i=!!a,i),n(0,o=!0)})});let o=!1,r=!1,l="";async function s(a){const{name:f,email:m,password:w,confirmPassword:p,signup:h}=a.detail,k=un(f,m,w,p,h);if(k!=""){n(2,l=k);return}h?await ie.signUp(f,m,w)?(n(2,l=""),te(le,i=!0,i)):n(2,l="Signup failed"):await ie.login(m,w)?(n(2,l=""),te(le,i=!0,i)):n(2,l="Invalid email or password")}function c(a){r=a,n(1,r)}return[o,r,l,i,s,c]}class dn extends G{constructor(e){super();K(this,e,fn,cn,V,{})}}new dn({target:document.body});

var Ge=Object.defineProperty,Be=Object.defineProperties;var Ke=Object.getOwnPropertyDescriptors;var re=Object.getOwnPropertySymbols;var Se=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable;var Te=(n,e,t)=>e in n?Ge(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,fe=(n,e)=>{for(var t in e||(e={}))Se.call(e,t)&&Te(n,t,e[t]);if(re)for(var t of re(e))Re.call(e,t)&&Te(n,t,e[t]);return n},de=(n,e)=>Be(n,Ke(e));var pe=(n,e)=>{var t={};for(var i in n)Se.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&re)for(var i of re(n))e.indexOf(i)<0&&Re.call(n,i)&&(t[i]=n[i]);return t};import{S as B,i as K,s as V,e as p,t as D,a as y,b as u,c as W,d as k,f as g,n as U,l as F,g as S,h as Ve,r as ge,j as Je,k as te,w as ce,m as Ye,o as me,p as he,N as we,U as Ze,q as Qe,u as ze,D as Oe,v as ye,x as ae,y as Xe,z as G,A as ke,G as je,L as Q,B as Ue,C as X,E as ue,F as R,H as J,I as Y,J as I,K as Z,M as j,O as x,P as xe,Q as et,R as tt,T as ee,V as nt,W as it,X as ot,Y as rt,Z as lt,_ as st,$ as at}from"./vendor.414db374.js";const ct=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}};ct();function Le(n){let e,t,i;return{c(){e=p("ion-item"),t=p("ion-label"),i=D(n[1])},m(o,r){y(o,e,r),u(e,t),u(t,i)},p(o,r){r&2&&W(i,o[1])},d(o){o&&k(e)}}}function Ce(n){let e,t;return{c(){e=p("ion-item"),t=p("ion-input"),g(t,"placeholder","Full Name"),g(t,"type","text"),g(t,"required","")},m(i,o){y(i,e,o),u(e,t),n[8](t)},p:U,d(i){i&&k(e),n[8](null)}}}function Ie(n){let e,t,i,o;return{c(){e=p("ion-item"),t=p("ion-input"),g(t,"placeholder","confirm password"),g(t,"type","password"),g(t,"required","")},m(r,l){y(r,e,l),u(e,t),n[11](t),i||(o=F(t,"keypress",n[7]),i=!0)},p:U,d(r){r&&k(e),n[11](null),i=!1,o()}}}function ut(n){let e,t,i,o=n[0]?"Sign up":"Login",r,l,s,a,c,f,_,h,m,b,d,v,w,L=n[0]?"Sign up":"Login",q,T,C,O=n[0]?"Login instead":"Sign up instead",E,H,ve,$=n[1]!==""&&Le(n),M=n[0]&&Ce(n),N=n[0]&&Ie(n);return{c(){e=p("ion-header"),t=p("ion-toolbar"),i=p("ion-title"),r=D(o),l=S(),s=p("ion-list"),$&&$.c(),a=S(),M&&M.c(),c=S(),f=p("ion-item"),_=p("ion-input"),h=S(),m=p("ion-item"),b=p("ion-input"),d=S(),N&&N.c(),v=S(),w=p("ion-button"),q=D(L),T=S(),C=p("ion-button"),E=D(O),g(e,"translucent",""),g(_,"placeholder","email"),g(_,"type","text"),g(_,"required",""),g(_,"autofocus",""),g(b,"placeholder","password"),g(b,"type","password"),g(b,"required",""),g(w,"expand","block"),g(s,"lines","full")},m(P,z){y(P,e,z),u(e,t),u(t,i),u(i,r),y(P,l,z),y(P,s,z),$&&$.m(s,null),u(s,a),M&&M.m(s,null),u(s,c),u(s,f),u(f,_),n[9](_),u(s,h),u(s,m),u(m,b),n[10](b),u(s,d),N&&N.m(s,null),u(s,v),u(s,w),u(w,q),y(P,T,z),y(P,C,z),u(C,E),_.focus(),H||(ve=[F(b,"keypress",function(){Ve(n[0]?void 0:n[7])&&(n[0]?void 0:n[7]).apply(this,arguments)}),F(w,"click",n[6]),F(C,"click",n[12])],H=!0)},p(P,[z]){n=P,z&1&&o!==(o=n[0]?"Sign up":"Login")&&W(r,o),n[1]!==""?$?$.p(n,z):($=Le(n),$.c(),$.m(s,a)):$&&($.d(1),$=null),n[0]?M?M.p(n,z):(M=Ce(n),M.c(),M.m(s,c)):M&&(M.d(1),M=null),n[0]?N?N.p(n,z):(N=Ie(n),N.c(),N.m(s,v)):N&&(N.d(1),N=null),z&1&&L!==(L=n[0]?"Sign up":"Login")&&W(q,L),z&1&&O!==(O=n[0]?"Login instead":"Sign up instead")&&W(E,O)},i:U,o:U,d(P){P&&k(e),P&&k(l),P&&k(s),$&&$.d(),M&&M.d(),n[9](null),n[10](null),N&&N.d(),P&&k(T),P&&k(C),H=!1,ge(ve)}}}function ft(n,e,t){const i=Je();function o(){!a||!c||r&&!f||i("submit",{name:s?s.value:void 0,email:a.value,password:c.value,confirmPassword:f?f.value:void 0,signup:r})}let{signup:r=!1}=e,{errorNote:l=""}=e,s,a,c,f;function _(w){w.key==="Enter"&&o()}function h(w){te[w?"unshift":"push"](()=>{s=w,t(2,s)})}function m(w){te[w?"unshift":"push"](()=>{a=w,t(3,a)})}function b(w){te[w?"unshift":"push"](()=>{c=w,t(4,c)})}function d(w){te[w?"unshift":"push"](()=>{f=w,t(5,f)})}const v=()=>t(0,r=!r);return n.$$set=w=>{"signup"in w&&t(0,r=w.signup),"errorNote"in w&&t(1,l=w.errorNote)},[r,l,s,a,c,f,o,_,h,m,b,d,v]}class dt extends B{constructor(e){super();K(this,e,ft,ut,V,{signup:0,errorNote:1})}}const pt=(n,e)=>{const t=localStorage.getItem(n),i=ce(t?JSON.parse(t):e);return i.subscribe(o=>localStorage.setItem(n,o?JSON.stringify(o):"")),i},le=ce(!1),A=ce(null),_e=ce(null),se=pt("currentTrip",null),mt=n=>{se.update(e=>e?(e.geopoints=[...e.geopoints,{timestamp:new Date().toISOString(),location:n}],e):null)},be=n=>{if(!n.length)return 0;let e=0;for(let t=1;t<n.length-1;++t)e+=Ye(n[t-1].location,n[t].location);return e},_t={toFirestore:n=>({name:n.name,email:n.email,credits:n.credits,redeemedRewards:n.redeemedRewards}),fromFirestore:(n,e)=>{const t=n.data(e);return{name:t.name,email:t.email,credits:t.credits,redeemedRewards:t.redeemedRewards}}},He={toFirestore:n=>({id:n.id,userEmail:n.userEmail,startTime:me.fromDate(n.startTime),endTime:n.endTime?me.fromDate(n.endTime):null,transportType:n.transportType,distance:n.distance,geopoints:n.geopoints}),fromFirestore:(n,e)=>{const t=n.data(e);return{id:t.id,userEmail:t.userEmail,startTime:t.startTime.toDate(),endTime:t.endTime?t.endTime.toDate():null,transportType:t.transportType,distance:t.distance,geopoints:t.geopoints}}},We={toFirestore:n=>({id:n.id,name:n.name,description:n.description,price:n.price,provider:n.provider,expiration:me.fromDate(n.expiration),remainingUnits:n.remainingUnits}),fromFirestore:(n,e)=>{const t=n.data(e);return{id:t.id,name:t.name,description:t.description,price:t.price,provider:t.provider,expiration:t.expiration.toDate(),remainingUnits:t.remainingUnits}}},oe=()=>Ze(),qe=n=>we(oe(),"users",n).withConverter(_t),bt=n=>we(oe(),"trips",n.id).withConverter(He),gt=n=>we(oe(),"rewards",n.id).withConverter(We),ht=async n=>{const o=n,{redeemedRewards:e}=o,t=pe(o,["redeemedRewards"]),i=de(fe({},t),{redeemedRewards:e.map(r=>r.id)});await he(qe(n.email),i)},wt=async n=>{await he(bt(n),n)},yt=async n=>{await he(gt(n),n)},kt=async n=>{const e=await Qe(qe(n));if(!e.exists())return null;const t=e.data(),s=t,{redeemedRewards:i}=s,o=pe(s,["redeemedRewards"]),r=await vt(t.email),l=(await Ae()).filter(a=>(i||[]).includes(a.id));return de(fe({},o),{trips:r,redeemedRewards:l})},vt=async n=>{const e=[];return(await ze(Oe(oe(),"trips").withConverter(He))).forEach(i=>i.exists()&&e.push(i.data())),e.filter(i=>i.userEmail===n)},Ae=async()=>{const n=[];return(await ze(Oe(oe(),"rewards").withConverter(We))).forEach(t=>t.exists()&&n.push(t.data())),n};var ne={fetchUser:kt,fetchAllRewards:Ae,updateUser:ht,updateTrip:wt,updateReward:yt};function Tt(n){let e,t,i,o;return{c(){e=p("div"),t=p("ion-fab-button"),t.innerHTML='<ion-icon name="add"></ion-icon>',ae(t,"pointer-events","auto"),ye(e,"class","leaflet-bottom")},m(r,l){y(r,e,l),u(e,t),i||(o=F(t,"click",n[4]),i=!0)},p:U,d(r){r&&k(e),i=!1,o()}}}function St(n){let e,t,i,o;return{c(){e=p("div"),t=p("ion-fab-button"),t.innerHTML='<ion-icon name="close"></ion-icon>',ae(t,"pointer-events","auto"),ye(e,"class","leaflet-bottom")},m(r,l){y(r,e,l),u(e,t),i||(o=F(t,"click",n[3]),i=!0)},p:U,d(r){r&&k(e),i=!1,o()}}}function Rt(n){let e,t,i;function o(s,a){return s[0]?St:Tt}let r=o(n),l=r(n);return{c(){e=p("div"),l.c(),ye(e,"class","map svelte-vsoji2"),ae(e,"height","100%"),ae(e,"width","100%")},m(s,a){y(s,e,a),l.m(e,null),t||(i=[F(window,"resize",n[2]),Xe(n[1].call(null,e))],t=!0)},p(s,[a]){r===(r=o(s))&&l?l.p(s,a):(l.d(1),l=r(s),l&&(l.c(),l.m(e,null)))},i:U,o:U,d(s){s&&k(e),l.d(),t=!1,ge(i)}}}function Ut(n,e,t){let i,o;G(n,se,d=>t(0,i=d)),G(n,A,d=>t(8,o=d));let r=null,l=null,s=null;const a=async()=>{const d=await je.getCurrentPosition();return{lat:d.coords.latitude,lng:d.coords.longitude}},c=d=>(r=Q.map(d,{preferCanvas:!0}),Q.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xA9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:20,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoicmVkNWg0ZDB3IiwiYSI6ImNrems4bzhzMzRrcG4yeHByYTgwN2draHcifQ.356a0A2cfoy3zrhq-IW_rA"}).addTo(r),r.setView([45.508888,-73.561668],14),{destroy:()=>{r==null||r.remove(),r=null}}),f=()=>r==null?void 0:r.invalidateSize(),_=async d=>{!r||(s==null||s.removeFrom(r),l==null||l.removeFrom(r),s=Q.circleMarker(d,{color:"red",weight:2,opacity:.7}),l=Q.polyline([d],{color:"red",weight:3,opacity:.5,smoothFactor:1}),s.addTo(r),l.addTo(r))},h=()=>{if(!r||!(i==null?void 0:i.geopoints.length))return;const d=i.geopoints.sort((v,w)=>v.timestamp<w.timestamp?-1:1).map(v=>[v.location.latitude,v.location.longitude]);s=Q.circleMarker(d[d.length-1],{color:"red",weight:2,opacity:.7}),l=Q.polyline(d,{color:"red",weight:3,opacity:.5,smoothFactor:1}),s.addTo(r),l.addTo(r)},m=()=>{if(!i)return;const d={id:i.id,userEmail:i.userEmail,transportType:i.transportType,startTime:new Date(i.startTime),endTime:new Date,distance:be(i.geopoints.map(v=>v.location)),geopoints:i.geopoints.map(({location:v,timestamp:w})=>({location:v,timestamp:new Date(w)}))};ne.updateTrip(d),se.set(null),r&&(l==null||l.removeFrom(r),s==null||s.removeFrom(r))},b=async()=>{se.set({id:Date.now().toString(),userEmail:o.email,startTime:new Date().toISOString(),transportType:"velo",geopoints:[]});const d=await a();_(d)};return ke(()=>{setInterval(async()=>{const d=await a();!i||(mt({latitude:d.lat,longitude:d.lng}),i.geopoints.length==0?_(d):l==null||l.addLatLng(d))},3e3),setTimeout(async()=>{const d=await a();r==null||r.setView(d),(i==null?void 0:i.geopoints.length)&&h(),f()},300)}),[i,c,f,m,b]}class Lt extends B{constructor(e){super();K(this,e,Ut,Rt,V,{})}}function Ct(n){let e,t,i,o=n[0].name+"",r,l,s,a=n[0].description+"",c,f,_,h,m=n[0].price+"",b,d,v,w,L=n[0].expiration?`Expires on ${n[0].expiration.toDateString()}`:"",q,T,C,O;return{c(){e=p("ion-card"),t=p("ion-card-header"),i=p("ion-card-title"),r=D(o),l=S(),s=p("ion-card-subtitle"),c=D(a),f=S(),_=p("ion-card-content"),h=D("Cost: "),b=D(m),d=D(` credits.\r
        `),v=p("br"),w=S(),q=D(L),g(s,"class","sub svelte-aab9bb"),g(_,"class","content svelte-aab9bb"),g(e,"class",T=Ue(n[1]?"redeemed":"notRedeemed")+" svelte-aab9bb")},m(E,H){y(E,e,H),u(e,t),u(t,i),u(i,r),u(t,l),u(t,s),u(s,c),u(e,f),u(e,_),u(_,h),u(_,b),u(_,d),u(_,v),u(_,w),u(_,q),C||(O=F(e,"click",n[2]),C=!0)},p(E,[H]){H&1&&o!==(o=E[0].name+"")&&W(r,o),H&1&&a!==(a=E[0].description+"")&&W(c,a),H&1&&m!==(m=E[0].price+"")&&W(b,m),H&1&&L!==(L=E[0].expiration?`Expires on ${E[0].expiration.toDateString()}`:"")&&W(q,L),H&2&&T!==(T=Ue(E[1]?"redeemed":"notRedeemed")+" svelte-aab9bb")&&g(e,"class",T)},i:U,o:U,d(E){E&&k(e),C=!1,O()}}}function It(n,e,t){let i;G(n,A,s=>t(3,i=s));let{reward:o}=e,{isRedeemed:r=!1}=e;function l(){!r||!o.remainingUnits||i.credits<o.price||(t(1,r=!0),i&&(X(A,i.credits-=o.price,i),t(0,o.remainingUnits--,o)))}return r=!0,A.update(s=>s?(s.credits-=o.price,s):null),n.$$set=s=>{"reward"in s&&t(0,o=s.reward),"isRedeemed"in s&&t(1,r=s.isRedeemed)},[o,r,l]}class Dt extends B{constructor(e){super();K(this,e,It,Ct,V,{reward:0,isRedeemed:1})}}function De(n,e,t){const i=n.slice();return i[3]=e[t],i}function Ee(n){let e,t,i=n[1],o=[];for(let l=0;l<i.length;l+=1)o[l]=$e(De(n,i,l));const r=l=>I(o[l],1,1,()=>{o[l]=null});return{c(){for(let l=0;l<o.length;l+=1)o[l].c();e=ue()},m(l,s){for(let a=0;a<o.length;a+=1)o[a].m(l,s);y(l,e,s),t=!0},p(l,s){if(s&2){i=l[1];let a;for(a=0;a<i.length;a+=1){const c=De(l,i,a);o[a]?(o[a].p(c,s),R(o[a],1)):(o[a]=$e(c),o[a].c(),R(o[a],1),o[a].m(e.parentNode,e))}for(j(),a=i.length;a<o.length;a+=1)r(a);x()}},i(l){if(!t){for(let s=0;s<i.length;s+=1)R(o[s]);t=!0}},o(l){o=o.filter(Boolean);for(let s=0;s<o.length;s+=1)I(o[s]);t=!1},d(l){xe(o,l),l&&k(e)}}}function $e(n){let e,t;return e=new Dt({props:{reward:n[3]}}),{c(){J(e.$$.fragment)},m(i,o){Y(e,i,o),t=!0},p(i,o){const r={};o&2&&(r.reward=i[3]),e.$set(r)},i(i){t||(R(e.$$.fragment,i),t=!0)},o(i){I(e.$$.fragment,i),t=!1},d(i){Z(e,i)}}}function Et(n){var b;let e,t,i,o,r,l,s=((b=n[0])==null?void 0:b.credits)+"",a,c,f,_,h,m=n[1]&&Ee(n);return{c(){e=p("ion-header"),t=p("ion-toolbar"),i=p("ion-title"),i.textContent="Rewards",o=S(),r=p("ion-subtitle"),l=D("You have "),a=D(s),c=D(" points to spend."),f=S(),_=p("ion-content"),m&&m.c(),g(e,"translucent",""),g(_,"fullscreen","")},m(d,v){y(d,e,v),u(e,t),u(t,i),u(t,o),u(t,r),u(r,l),u(r,a),u(r,c),y(d,f,v),y(d,_,v),m&&m.m(_,null),h=!0},p(d,[v]){var w;(!h||v&1)&&s!==(s=((w=d[0])==null?void 0:w.credits)+"")&&W(a,s),d[1]?m?(m.p(d,v),v&2&&R(m,1)):(m=Ee(d),m.c(),R(m,1),m.m(_,null)):m&&(j(),I(m,1,1,()=>{m=null}),x())},i(d){h||(R(m),h=!0)},o(d){I(m),h=!1},d(d){d&&k(e),d&&k(f),d&&k(_),m&&m.d()}}}function $t(n,e,t){let i,o;return G(n,A,r=>t(0,i=r)),G(n,_e,r=>t(1,o=r)),A.subscribe(r=>{}),[i,o]}class Mt extends B{constructor(e){super();K(this,e,$t,Et,V,{})}}function Nt(n){let e,t,i,o,r,l,s,a;return{c(){e=p("ion-list"),t=p("ion-item"),t.innerHTML=`Logout
        <ion-icon name="log-out-outline" slot="end"></ion-icon>`,i=S(),o=p("ion-item"),o.innerHTML=`about
        <ion-icon name="information-circle-outline" slot="end"></ion-icon>`,r=S(),l=p("ion-item"),l.innerHTML=`GitHub Repo
        <ion-icon name="logo-github" slot="end"></ion-icon>`,g(t,"button",""),g(o,"button",""),g(l,"lines","none"),g(l,"button",""),g(e,"lines","n")},m(c,f){y(c,e,f),u(e,t),u(e,i),u(e,o),u(e,r),u(e,l),s||(a=[F(t,"click",n[1]),F(o,"click",n[2]),F(l,"click",n[3])],s=!0)},p:U,i:U,o:U,d(c){c&&k(e),s=!1,ge(a)}}}function Pt(n){let e=document.querySelector("ion-popover");const t=l=>{e.dismiss(l)};return[t,()=>{t("logout")},()=>{t("about")},()=>{t("github")}]}class Ft extends B{constructor(e){super();K(this,e,Pt,Nt,V,{})}}const zt=function(n){return document.createElement(n).constructor!==HTMLElement},Ot=(n,e)=>{zt(n)||tt(n,e,[])},Ht=(n,e,t,i)=>(Ot(e,t),et.create({component:e,event:n,componentProps:i}).then(o=>(o.present(),o.onWillDismiss()))),Wt=()=>!!ee().currentUser,qt=()=>{var n;return((n=ee().currentUser)==null?void 0:n.email)||null},At=async(n,e)=>{try{return await nt(ee(),n,e),!0}catch(t){return console.log("Failed to login"),console.log(t),!1}},Gt=()=>ee().signOut(),Bt=async(n,e,t)=>{try{return await it(ee(),e,t),await ne.updateUser({email:e,name:n,credits:0,redeemedRewards:[],trips:[]}),!0}catch(i){return console.log("Failed to sign up"),console.log(i),!1}};var ie={logout:Gt,login:At,getCurrentUser:qt,isLoggedIn:Wt,signUp:Bt};function Kt(n){let e,t,i,o,r,l=be(n[0].geopoints)+"",s;return{c(){e=p("ion-item"),t=p("ion-icon"),o=S(),r=p("ion-label"),s=D(l),g(t,"name",i=Me(n[0].transportType)),g(t,"slot","start")},m(a,c){y(a,e,c),u(e,t),u(e,o),u(e,r),u(r,s)},p(a,[c]){c&1&&i!==(i=Me(a[0].transportType))&&g(t,"name",i),c&1&&l!==(l=be(a[0].geopoints)+"")&&W(s,l)},i:U,o:U,d(a){a&&k(e)}}}function Me(n){switch(n){case"bicycle":return"bicycle";case"walk":return"walk";case"public_transport":return"bus";default:return"walk"}}function Vt(n,e,t){let{trip:i}=e;return n.$$set=o=>{"trip"in o&&t(0,i=o.trip)},[i]}class Jt extends B{constructor(e){super();K(this,e,Vt,Kt,V,{trip:0})}}function Ne(n,e,t){const i=n.slice();return i[3]=e[t],i}function Yt(n){let e,t,i,o,r,l;return{c(){e=p("ion-item"),t=p("ion-label"),t.textContent="Failed to load user",i=S(),o=p("ion-button"),o.textContent="Go back to login page",g(o,"slot","end"),g(o,"fill","outline")},m(s,a){y(s,e,a),u(e,t),u(e,i),u(e,o),r||(l=F(o,"click",n[2]),r=!0)},p:U,i:U,o:U,d(s){s&&k(e),r=!1,l()}}}function Zt(n){let e,t,i=[],o=new Map,r,l,s=n[0].trips;const a=c=>c[3].id;for(let c=0;c<s.length;c+=1){let f=Ne(n,s,c),_=a(f);o.set(_,i[c]=Pe(_,f))}return{c(){e=p("ion-list-header"),e.innerHTML="<ion-label>Trips</ion-label>",t=S();for(let c=0;c<i.length;c+=1)i[c].c();r=ue()},m(c,f){y(c,e,f),y(c,t,f);for(let _=0;_<i.length;_+=1)i[_].m(c,f);y(c,r,f),l=!0},p(c,f){f&1&&(s=c[0].trips,j(),i=ot(i,f,a,1,c,s,o,r.parentNode,rt,Pe,r,Ne),x())},i(c){if(!l){for(let f=0;f<s.length;f+=1)R(i[f]);l=!0}},o(c){for(let f=0;f<i.length;f+=1)I(i[f]);l=!1},d(c){c&&k(e),c&&k(t);for(let f=0;f<i.length;f+=1)i[f].d(c);c&&k(r)}}}function Pe(n,e){let t,i,o;return i=new Jt({props:{trip:e[3]}}),{key:n,first:null,c(){t=ue(),J(i.$$.fragment),this.first=t},m(r,l){y(r,t,l),Y(i,r,l),o=!0},p(r,l){e=r;const s={};l&1&&(s.trip=e[3]),i.$set(s)},i(r){o||(R(i.$$.fragment,r),o=!0)},o(r){I(i.$$.fragment,r),o=!1},d(r){r&&k(t),Z(i,r)}}}function Qt(n){let e,t,i,o,r,l,s=(n[0]?n[0].name:"Profile")+"",a,c,f,_,h,m,b,d,v;const w=[Zt,Yt],L=[];function q(T,C){return T[0]?0:1}return h=q(n),m=L[h]=w[h](n),{c(){e=p("ion-header"),t=p("ion-toolbar"),i=p("ion-buttons"),o=p("ion-button"),o.innerHTML='<ion-icon slot="icon-only" ios="ellipsis-horizontal" md="ellipsis-vertical"></ion-icon>',r=S(),l=p("ion-title"),a=D(s),c=S(),f=p("ion-content"),_=p("ion-list"),m.c(),g(i,"slot","primary"),g(e,"translucent","")},m(T,C){y(T,e,C),u(e,t),u(t,i),u(i,o),u(t,r),u(t,l),u(l,a),y(T,c,C),y(T,f,C),u(f,_),L[h].m(_,null),b=!0,d||(v=F(o,"click",n[1]),d=!0)},p(T,[C]){(!b||C&1)&&s!==(s=(T[0]?T[0].name:"Profile")+"")&&W(a,s);let O=h;h=q(T),h===O?L[h].p(T,C):(j(),I(L[O],1,1,()=>{L[O]=null}),x(),m=L[h],m?m.p(T,C):(m=L[h]=w[h](T),m.c()),R(m,1),m.m(_,null))},i(T){b||(R(m),b=!0)},o(T){I(m),b=!1},d(T){T&&k(e),T&&k(c),T&&k(f),L[h].d(),d=!1,v()}}}function Xt(n,e,t){let i;G(n,A,l=>t(0,i=l));function o(l){Ht(l,"popover-extra",Ft,{}).then(async s=>{s.data=="logout"&&await ie.logout()})}return[i,o,()=>ie.logout()]}class jt extends B{constructor(e){super();K(this,e,Xt,Qt,V,{})}}function xt(n){let e,t,i,o,r,l,s,a,c,f,_,h,m;return o=new Lt({}),s=new Mt({}),f=new jt({}),{c(){e=p("ion-app"),t=p("ion-tabs"),i=p("ion-tab"),J(o.$$.fragment),r=S(),l=p("ion-tab"),J(s.$$.fragment),a=S(),c=p("ion-tab"),J(f.$$.fragment),_=S(),h=p("ion-tab-bar"),h.innerHTML=`<ion-tab-button tab="map"><ion-label>Map</ion-label> 
        <ion-icon name="bicycle-outline"></ion-icon></ion-tab-button> 
      <ion-tab-button tab="rewards"><ion-label>Rewards</ion-label> 
        <ion-icon name="trophy-outline"></ion-icon></ion-tab-button> 
      <ion-tab-button tab="profile"><ion-label>profile</ion-label> 
        <ion-icon name="analytics-outline"></ion-icon></ion-tab-button>`,g(i,"tab","map"),g(l,"tab","rewards"),g(c,"tab","profile"),g(h,"slot","bottom")},m(b,d){y(b,e,d),u(e,t),u(t,i),Y(o,i,null),u(t,r),u(t,l),Y(s,l,null),u(t,a),u(t,c),Y(f,c,null),u(t,_),u(t,h),m=!0},p:U,i(b){m||(R(o.$$.fragment,b),R(s.$$.fragment,b),R(f.$$.fragment,b),m=!0)},o(b){I(o.$$.fragment,b),I(s.$$.fragment,b),I(f.$$.fragment,b),m=!1},d(b){b&&k(e),Z(o),Z(s),Z(f)}}}function en(n,e,t){let i,o;return G(n,_e,r=>t(0,i=r)),G(n,A,r=>t(1,o=r)),ke(async()=>{const r=await ne.fetchUser(ie.getCurrentUser());X(A,o=r,o);const l=await ne.fetchAllRewards();X(_e,i=l,i)}),A.subscribe(async r=>{r&&await ne.updateUser(r)}),[]}class tn extends B{constructor(e){super();K(this,e,en,xt,V,{})}}function Fe(n){let e,t,i,o;const r=[on,nn],l=[];function s(a,c){return a[3]?1:0}return e=s(n),t=l[e]=r[e](n),{c(){t.c(),i=ue()},m(a,c){l[e].m(a,c),y(a,i,c),o=!0},p(a,c){let f=e;e=s(a),e===f?l[e].p(a,c):(j(),I(l[f],1,1,()=>{l[f]=null}),x(),t=l[e],t?t.p(a,c):(t=l[e]=r[e](a),t.c()),R(t,1),t.m(i.parentNode,i))},i(a){o||(R(t),o=!0)},o(a){I(t),o=!1},d(a){l[e].d(a),a&&k(i)}}}function nn(n){let e,t;return e=new tn({}),{c(){J(e.$$.fragment)},m(i,o){Y(e,i,o),t=!0},p:U,i(i){t||(R(e.$$.fragment,i),t=!0)},o(i){I(e.$$.fragment,i),t=!1},d(i){Z(e,i)}}}function on(n){let e,t,i;function o(l){n[5](l)}let r={errorNote:n[2]};return n[1]!==void 0&&(r.signup=n[1]),e=new dt({props:r}),te.push(()=>lt(e,"signup",o)),e.$on("submit",n[4]),{c(){J(e.$$.fragment)},m(l,s){Y(e,l,s),i=!0},p(l,s){const a={};s&4&&(a.errorNote=l[2]),!t&&s&2&&(t=!0,a.signup=l[1],st(()=>t=!1)),e.$set(a)},i(l){i||(R(e.$$.fragment,l),i=!0)},o(l){I(e.$$.fragment,l),i=!1},d(l){Z(e,l)}}}function rn(n){let e,t,i=n[0]&&Fe(n);return{c(){e=p("ion-app"),i&&i.c()},m(o,r){y(o,e,r),i&&i.m(e,null),t=!0},p(o,[r]){o[0]?i?(i.p(o,r),r&1&&R(i,1)):(i=Fe(o),i.c(),R(i,1),i.m(e,null)):i&&(j(),I(i,1,1,()=>{i=null}),x())},i(o){t||(R(i),t=!0)},o(o){I(i),t=!1},d(o){o&&k(e),i&&i.d()}}}function ln(n,e,t,i,o){return o&&t!==i?"Passwords do not match":""}function sn(n,e,t){let i;G(n,le,c=>t(3,i=c)),ke(()=>{at({apiKey:"AIzaSyClWb9snAaau0p3gWecoCVMywUwIKgP7Eo",authDomain:"hackatown-2022.firebaseapp.com",projectId:"hackatown-2022",storageBucket:"hackatown-2022.appspot.com",messagingSenderId:"410454368204",appId:"1:410454368204:web:16fa9750c1621761564769"}),ee().onAuthStateChanged(c=>{X(le,i=!!c,i),t(0,o=!0)})});let o=!1,r=!1,l="";async function s(c){const{name:f,email:_,password:h,confirmPassword:m,signup:b}=c.detail,d=ln(f,_,h,m,b);if(d!=""){t(2,l=d);return}b?await ie.signUp(f,_,h)?(t(2,l=""),X(le,i=!0,i)):t(2,l="Signup failed"):await ie.login(_,h)?(t(2,l=""),X(le,i=!0,i)):t(2,l="Invalid email or password")}function a(c){r=c,t(1,r)}return[o,r,l,i,s,a]}class an extends B{constructor(e){super();K(this,e,sn,rn,V,{})}}new an({target:document.body});
